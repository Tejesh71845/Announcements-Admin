<mvc:View
    controllerName="com.incture.announcements.controller.Announcement"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    xmlns:f="sap.f"
    displayBlock="true"
    height="100%"
>
    <!-- ShellBar at the top -->
    <core:Fragment
        fragmentName="com.incture.announcements.fragments.ShellBar"
        type="XML"
    />

    <!-- Main Content -->

    <smartTable:SmartTable
        id="idAnnouncementsSmartTbl"
        entitySet="Announcements"
        tableType="ResponsiveTable"
        enableAutoBinding="true"
        useVariantManagement="true"
        useTablePersonalisation="true"
        header="Announcements"
        showRowCount="true"
        enableCopy="false"
        enableExport="false"
        demandPopin="true"
        class="sapUiResponsiveMargin smartTableBorderCss"
        beforeRebindTable="onBeforeRebindTable"
        enableAutoColumnWidth="true"
        placeToolbarInTable="true"
        requestAtLeastFields="description,announcementStatus,announcementType"
    >
        <smartTable:customToolbar>
            <OverflowToolbar design="Transparent">
                <SegmentedButton
                    selectedKey="all"
                    selectionChange="onFilterChange"
                >
                    <items>
                        <SegmentedButtonItem
                            key="all"
                            text="All"
                        />
                        <SegmentedButtonItem
                            key="published"
                            text="Published"
                        />
                        <SegmentedButtonItem
                            key="scheduled"
                            text="Scheduled"
                        />
                        <SegmentedButtonItem
                            key="expired"
                            text="Expired"
                        />
                        <SegmentedButtonItem
                            key="invalid"
                            text="Invalid"
                        />
                    </items>
                </SegmentedButton>
                <ToolbarSpacer />
                <SearchField
                    width="20%"
                    class="sapUiSmallMargin"
                />
                <MenuButton
                    id="idCreateAnnouncementMenuBtn"
                    text="{i18n>createButton}"
                    type="Emphasized"
                    defaultAction="onCreateSidebarPress"
                >
                    <menu>
                        <Menu>
                            <MenuItem
                                text="Create Sidebar Announcement"
                                press="onCreateSidebarPress"
                            />
                            <MenuItem
                                text="Create Banner Announcement"
                                press="onCreateBannerPress"
                            />
                        </Menu>
                    </menu>
                </MenuButton>
            </OverflowToolbar>
        </smartTable:customToolbar>
        <smartTable:layoutData>
            <FlexItemData
                growFactor="1"
                baseSize="0%"
            />
        </smartTable:layoutData>
        <Table
            growing="true"
            growingThreshold="10"
        >
            <columns>
                <Column>
                    <Text text="{i18n>publishedOnColumn}" />
                    <customData>
                        <core:CustomData
                            key="p13nData"
                            value="{'columnKey': 'publishedAt', 'columnIndex': '3', 'leadingProperty': 'publishedAt'}"
                        />
                    </customData>
                </Column>

                <Column>
                    <Text text="{i18n>expiredOnColumn}" />
                    <customData>
                        <core:CustomData
                            key="p13nData"
                            value="{'columnKey': 'endAnnouncement', 'columnIndex': '4', 'leadingProperty': 'endAnnouncement'}"
                        />
                    </customData>
                </Column>

                <Column>
                    <Text text="{i18n>modifiedOnColumn}" />
                    <customData>
                        <core:CustomData
                            key="p13nData"
                            value="{'columnKey': 'modifiedAt', 'columnIndex': '5', 'leadingProperty': 'modifiedAt'}"
                        />
                    </customData>
                </Column>

                <Column>
                    <Text text="{i18n>statusColumn}" />
                    <customData>
                        <core:CustomData
                            key="p13nData"
                            value="{'columnKey': 'announcementStatus', 'columnIndex': '6', 'leadingProperty': 'announcementStatus'}"
                        />
                    </customData>
                </Column>
                <Column>
                    <Text text="{i18n>actionsColumn}" />
                    <customData>
                        <core:CustomData
                            key="p13nData"
                            value="{'columnKey': 'Actions', 'columnIndex': '31', 'leadingProperty': 'Actions', 'sortProperty': 'Actions', 'filterProperty': 'Actions'}"
                        />
                    </customData>
                </Column>
            </columns>
            <items>
                <ColumnListItem type="Active">
                    <cells>
                        <Text
                            text="{
                                                path: 'publishedAt',
                                                formatter: '.formatDateOnly'
                                            }"
                        />

                        <Text
                            text="{
                                                path: 'endAnnouncement',
                                                formatter: '.formatDateOnly'
                                            }"
                        />

                        <Text
                            text="{
                                                path: 'modifiedAt',
                                                formatter: '.formatDateOnly'
                                            }"
                        />

                        <ObjectStatus
                            text="{
        path: 'announcementStatus',
        formatter: '.formatter.formatStatusText'
    }"
                            state="{
        path: 'announcementStatus',
        formatter: '.formatter.formatStatusState'
    }"
                            icon="{
        path: 'announcementStatus',
        formatter: '.formatter.formatStatusIcon'
    }"
                            inverted="true"
                        />

                        <HBox>
                            <Button
                                icon="sap-icon://edit"
                                type="Transparent"
                                tooltip="Edit"
                                press="onEditPress"
                            />
                            <Button
                                icon="sap-icon://duplicate"
                                type="Transparent"
                                tooltip="Duplicate"
                            />
                            <Button
                                icon="sap-icon://sys-minus"
                                type="Transparent"
                                tooltip="Mark As Invalid"
                            />
                            <Button
                                icon="sap-icon://delete"
                                type="Transparent"
                                tooltip="Delete"
                                press="onDeletePress"
                            />
                        </HBox>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </smartTable:SmartTable>
</mvc:View>
